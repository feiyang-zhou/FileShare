<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>通平台数据处理工具说明文档（东软-王琳版本）</title>
    <style>
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #27ae60;
            padding-bottom: 10px;
            margin-bottom: 30px;
            text-align: center;
        }
        h2 {
            color: #34495e;
            border-left: 4px solid #27ae60;
            padding-left: 15px;
            margin-top: 30px;
            margin-bottom: 20px;
        }
        h3 {
            color: #2c3e50;
            margin-top: 25px;
            margin-bottom: 15px;
        }
        h4 {
            color: #34495e;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        .emoji {
            font-size: 1.2em;
            margin-right: 8px;
        }
        ul, ol {
            margin-bottom: 15px;
            padding-left: 25px;
        }
        li {
            margin-bottom: 8px;
        }
        .highlight {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
        }
        .code-block {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Consolas', 'Monaco', monospace;
            overflow-x: auto;
            font-size: 14px;
            white-space: pre-wrap;
            line-height: 1.4;
        }
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .feature-card {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            transition: transform 0.2s ease;
            border-top: 4px solid #27ae60;
        }
        .feature-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .feature-card h4 {
            color: #495057;
            margin-top: 0;
            margin-bottom: 12px;
        }
        .step-list {
            counter-reset: step-counter;
            list-style: none;
            padding: 0;
        }
        .step-list li {
            counter-increment: step-counter;
            position: relative;
            padding-left: 40px;
            margin-bottom: 15px;
            background-color: #f8f9fa;
            padding: 15px 15px 15px 50px;
            border-radius: 8px;
            border-left: 4px solid #27ae60;
        }
        .step-list li::before {
            content: counter(step-counter);
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            background-color: #27ae60;
            color: white;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
        }
        .table-container {
            overflow-x: auto;
            margin: 15px 0;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 0;
            background: white;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #27ae60;
            color: white;
            font-weight: bold;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        tr:hover {
            background-color: #f0f8ff;
        }
        .success {
            color: #27ae60;
            font-weight: bold;
        }
        .error {
            color: #e74c3c;
            font-weight: bold;
        }
        .info {
            background-color: #e8f5e8;
            border: 1px solid #27ae60;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
        }
        .warning {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
        }
        .special-feature {
            background-color: #e8f5e8;
            border: 2px solid #27ae60;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .special-feature h3 {
            color: #27ae60;
            margin-top: 0;
        }
        .toc {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
        }
        .toc h3 {
            margin-top: 0;
            color: #495057;
        }
        .toc ul {
            columns: 2;
            column-gap: 30px;
        }
        .toc a {
            color: #27ae60;
            text-decoration: none;
        }
        .toc a:hover {
            text-decoration: underline;
        }
        .format-example {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        .format-example h4 {
            color: #495057;
            margin-bottom: 10px;
        }
        @media (max-width: 768px) {
            .toc ul {
                columns: 1;
            }
            .feature-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1><span class="emoji">📋</span>通平台数据处理工具说明文档（东软-王琳版本）</h1>

        <div class="toc">
            <h3>📋 目录导航</h3>
            <ul>
                <li><a href="#overview">工具概述</a></li>
                <li><a href="#features">功能特点</a></li>
                <li><a href="#requirements">数据要求</a></li>
                <li><a href="#formats">数据格式要求</a></li>
                <li><a href="#department-recognition">科室结构识别</a></li>
                <li><a href="#output">输出格式</a></li>
                <li><a href="#usage">使用步骤</a></li>
                <li><a href="#notes">注意事项</a></li>
                <li><a href="#dongsoft-features">东软版本特性</a></li>
            </ul>
        </div>

        <div id="overview">
            <h2><span class="emoji">📋</span>工具概述</h2>
            <p>通平台数据处理工具（东软版本）是一个专业的医疗数据标准化处理系统，专门针对东软医院信息系统的数据格式进行优化。该工具能够将单一的药品使用信息Excel文件转换为标准化的目标表格，支持复杂的科室结构识别和医保编码处理。本版本采用智能表头检测和数据聚合处理技术，具有强大的适应性和灵活性。</p>
        </div>
        <div id="features">
            <h2><span class="emoji">🔧</span>核心特性</h2>
            
            <h3>双文件输入模式</h3>
            <p>东软-王琳版本支持两个文件输入模式：</p>
            
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>主要模式：双文件输入</h4>
                    <ul>
                        <li><strong>药品目录表</strong>：包含药品基础信息的Excel文件</li>
                        <li><strong>科室使用信息表</strong>：包含科室药品使用记录的Excel文件</li>
                    </ul>
                </div>
            </div>
        </div>

        <div id="features">
            <h2><span class="emoji">🔧</span>功能特点</h2>
            
            <h3>1. 核心功能</h3>
            <ul>
                <li><strong>医疗数据标准化处理</strong>：将药品使用信息Excel文件转换为标准化的目标表格</li>
                <li><strong>四工作表输出</strong>：生成包含4个工作表的Excel文件
                    <ul>
                        <li>医院药品信息表</li>
                        <li>药品使用信息表</li>
                        <li>科室信息表（支持四级结构）</li>
                        <li>药费及人次汇总表</li>
                    </ul>
                </li>
            </ul>

            <h3>2. 高级特性</h3>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>智能表头检测</h4>
                    <p>自动识别和适配不同格式的Excel表头结构</p>
                </div>
                <div class="feature-card">
                    <h4>数据聚合处理</h4>
                    <p>将药品目录和科室使用信息合并生成标准化数据，然后自动按科室+药品编码进行聚类，累加使用量和金额</p>
                </div>
                <div class="feature-card">
                    <h4>动态科室结构识别</h4>
                    <p>支持四级科室结构的智能识别和分类</p>
                </div>
                <div class="feature-card">
                    <h4>科室结构总表维护</h4>
                    <p>自动维护桌面科室结构总表，确保科室ID一致性</p>
                </div>
                <div class="feature-card">
                    <h4>智能医保编码处理</h4>
                    <p>自动识别和处理医保编码信息</p>
                </div>
                <div class="feature-card">
                    <h4>前导零格式保护</h4>
                    <p>确保科室ID保持正确格式（如029000而非29000.0）</p>
                </div>
                <div class="feature-card">
                    <h4>新增科室高亮</h4>
                    <p>新增科室在总表中自动标记为绿色高亮</p>
                </div>
                <div class="feature-card">
                    <h4>临时文件自动清理</h4>
                    <p>处理完成后自动清理临时文件</p>
                </div>
            </div>

            <h3>3. 用户界面特性</h3>
            <ul>
                <li><strong>图形化界面</strong>：友好GUI界面，集成Logo显示</li>
                <li><strong>实时日志显示</strong>：处理过程实时显示详细日志</li>
                <li><strong>进度条显示</strong>：可视化处理进度</li>
                <li><strong>文件自动检测</strong>：智能查找和识别数据文件</li>
                <li><strong>版本选择支持</strong>：支持通平台1.4和1.5版本切换</li>
            </ul>
        </div>

        <div id="requirements">
            <h2><span class="emoji">📁</span>数据要求</h2>
            
            <h3>必需文件（2个）</h3>
            <ol>
                <li><strong>医院药品目录</strong>
                    <ul>
                        <li>格式：Excel文件（.xlsx/.xls）</li>
                        <li>包含完整的药品数据</li>
                        <li>支持智能表头检测，自动适配不同的列名格式</li>
                    </ul>
                </li>
                <li><strong>药品使用信息</strong>
                    <ul>
                        <li>格式：Excel文件（.xlsx/.xls）</li>
                        <li>包含完整的药品使用详细数据</li>
                        <li>支持智能表头检测，自动适配不同的列名格式</li>
                    </ul>
                </li>
            </ol>

            <h3>可选文件（1个）</h3>
            <ol>
                <li><strong>科室结构总表</strong>
                    <ul>
                        <li>自定义科室结构，不选择时使用桌面默认表</li>
                    </ul>
                </li>
            </ol>
        </div>

        <div id="requirements">
            <h2><span class="emoji">📁</span>输入数据要求</h2>
            
            <h3>必需文件</h3>

            <h4>1. 药品目录表 (Excel格式)</h4>
            <p><strong>必需列及要求</strong>：</p>
            
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>列名</th>
                            <th>数据类型</th>
                            <th>说明</th>
                            <th>示例</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>编码</td>
                            <td>字符串</td>
                            <td>药品唯一标识，用于与科室使用信息匹配</td>
                            <td>"A001", "B002"</td>
                        </tr>
                        <tr>
                            <td>药品名称</td>
                            <td>字符串</td>
                            <td>药品的完整名称</td>
                            <td>"阿司匹林肠溶片"</td>
                        </tr>
                        <tr>
                            <td>规格</td>
                            <td>字符串</td>
                            <td>药品规格描述</td>
                            <td>"100mg*30片"</td>
                        </tr>
                        <tr>
                            <td>零售价</td>
                            <td>数值</td>
                            <td>药品零售价格(元)</td>
                            <td>15.50</td>
                        </tr>
                        <tr>
                            <td>生产厂家</td>
                            <td>字符串</td>
                            <td>药品生产厂家信息</td>
                            <td>"拜耳医药有限公司"</td>
                        </tr>
                        <tr>
                            <td>购入价</td>
                            <td>数值</td>
                            <td>医院购入价格(元)</td>
                            <td>12.80</td>
                        </tr>
                        <tr>
                            <td>医保编码</td>
                            <td>字符串</td>
                            <td>国家医保编码</td>
                            <td>"XJ01CR02"</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="warning">
                <h4>数据格式要求：</h4>
                <ul>
                    <li>文件格式：Excel (.xlsx 或 .xls)</li>
                    <li>编码列不能有重复值</li>
                    <li>数值列必须为有效数字</li>
                    <li>字符串列不能全为空</li>
                </ul>
            </div>

            <h4>2. 科室使用信息表 (Excel格式)</h4>
            <p><strong>必需列及要求</strong>：</p>
            
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>列名</th>
                            <th>数据类型</th>
                            <th>说明</th>
                            <th>示例</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>绩效科室</td>
                            <td>字符串</td>
                            <td>科室名称，用于科室结构识别</td>
                            <td>"心内科一病房", "妇科A组门诊"</td>
                        </tr>
                        <tr>
                            <td>收费项目</td>
                            <td>字符串</td>
                            <td>对应药品目录的编码</td>
                            <td>"A001", "B002"</td>
                        </tr>
                        <tr>
                            <td>数量</td>
                            <td>数值</td>
                            <td>使用数量</td>
                            <td>50, 120</td>
                        </tr>
                        <tr>
                            <td>金额</td>
                            <td>数值</td>
                            <td>使用金额(元)</td>
                            <td>775.00, 1536.00</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="warning">
                <h4>数据格式要求：</h4>
                <ul>
                    <li>文件格式：Excel (.xlsx 或 .xls)</li>
                    <li>收费项目必须在药品目录表中存在</li>
                    <li>数量和金额必须为正数</li>
                    <li>同一科室同一药品可以有多条记录（系统会自动聚合）</li>
                </ul>
            </div>

            <h4>数据聚合逻辑</h4>
            <div class="info">
                <p>系统会按照<strong>科室+药品编码</strong>进行数据聚合：</p>
                <ul>
                    <li><strong>求和字段</strong>：使用量</li>
                    <li><strong>保留字段</strong>：其他所有字段保留第一个值</li>
                    <li><strong>重新计算</strong>：聚合后重新计算总金额 = 使用量 × 单价</li>
                </ul>
            </div>

            <h4>输出列名映射</h4>
            <div class="format-example">
                <p>原始列名会自动映射为标准化列名：</p>
                <ul>
                    <li>领药科室/科室名称 → 科室名称</li>
                    <li>药品编码/药品代码 → 药品编码</li>
                    <li>发生数量/数量 → 使用量</li>
                    <li>零售总金额/总金额 → 使用金额</li>
                    <li>国家编码/医保编码 → 医保编码</li>
                    <li>药品编码 → 医院药品ID</li>
                </ul>
            </div>

            <h3>数据处理特点</h3>

            <h4>1. 智能表头检测系统</h4>
            <ul>
                <li><strong>多行扫描</strong>：自动检查多行，寻找最佳的列名行</li>
                <li><strong>关键词匹配</strong>：基于必须列的关键词进行智能匹配</li>
                <li><strong>评分机制</strong>：根据匹配度和有效列数进行评分</li>
                <li><strong>回退机制</strong>：智能检测失败时自动回退到传统方式</li>
            </ul>

            <h4>2. 数据清洗和转换</h4>
            <ul>
                <li><strong>数据类型转换</strong>：自动将数量和金额列转换为数值类型</li>
                <li><strong>空值处理</strong>：智能处理空值和异常数据</li>
                <li><strong>重复数据合并</strong>：按科室和药品编码自动合并重复记录</li>
                <li><strong>格式标准化</strong>：统一数据格式和命名规范</li>
            </ul>

            <h4>3. 容错处理机制</h4>
            <ul>
                <li><strong>列名变体识别</strong>：支持列名的多种变体形式</li>
                <li><strong>特殊字符处理</strong>：自动处理列名中的换行符(\n)、空格等</li>
                <li><strong>缺失列补充</strong>：自动为缺失的列设置默认值</li>
                <li><strong>异常数据处理</strong>：自动处理和修复异常数据</li>
            </ul>
        </div>

        <div id="department-recognition" class="special-feature">
            <h2><span class="emoji">🏥</span>科室结构识别</h2>
            
            <h3>四级结构识别系统</h3>
            <p>系统采用先进的正则表达式和模式匹配算法，能够智能识别复杂的科室层级结构：</p>

            <h4>1. 四级结构识别模式</h4>
            <div class="code-block"># 模式1：科室名+数字+后缀
(.+?)(一|二|三|四|五|六|七|八|九|十|1|2|3|4|5|6|7|8|9|10|11|12)(病房|区|科|病区|诊室|监护室|重症|ICU|室|疗区)$

# 模式2：科室名+数字（纯数字结尾）
(.+?)(一|二|三|四|五|六|七|八|九|十|1|2|3|4|5|6|7|8|9|10|11|12)科?$

# 模式3：科室名+英文字母+后缀
(.+?)([a-zA-Z])(病房|区|科|病区|诊室|监护室|重症|ICU|室|疗区|组)$

# 模式4：科室名+英文字母（纯字母结尾）
(.+?)([a-zA-Z])$

# 模式5：科室名+数字+字母
(.+?)(一|二|三|四|五|六|七|八|九|十|1|2|3|4|5|6|7|8|9|10|11|12)([A-Z])$</div>

            <h4>2. 识别示例</h4>
            <ul>
                <li><strong>心内科一病房</strong> → 基础科室：心内科，子单元：一病房，类型：住院</li>
                <li><strong>外科二区</strong> → 基础科室：外科，子单元：二区，类型：住院</li>
                <li><strong>儿科1科</strong> → 基础科室：儿科，子单元：1科，类型：住院</li>
                <li><strong>妇科A组门诊</strong> → 基础科室：妇科，子单元：A组，类型：门诊</li>
                <li><strong>肾内科a区</strong> → 基础科室：肾内科，子单元：a区，类型：住院</li>
            </ul>

            <h4>3. 白名单排除机制</h4>
            <p>以下科室即使匹配四级结构模式，也不会被识别为四级结构：</p>
            <div class="code-block">whitelist_depts = [
    'CT室', 'MRI室', 'DR室', 'DSA室', 'B超室',  # 影像科室
    'CT科',  # CT科不要被判断为四级结构
    '核医学科PET-CT', 'DMD多学科联合门诊',  # 特殊科室
]</div>

            <h3>科室ID分配规则</h3>
            <ul>
                <li><strong>一级结构</strong>：全院合计 (ID: 01)</li>
                <li><strong>二级结构</strong>：基础科室或科室组 (ID: 001, 002, ...)</li>
                <li><strong>三级结构</strong>：具体科室类型 (ID: 0010, 0011, ...)</li>
                <li><strong>四级结构</strong>：科室子单元 (ID: 00101, 00102, ...)</li>
            </ul>

            <h3>科室分组逻辑</h3>
            <ul>
                <li><strong>混合科室</strong>：同时有门诊和住院的基础科室保持独立二级结构</li>
                <li><strong>其他门诊</strong>：仅有门诊的科室归入"其他门诊"二级结构</li>
                <li><strong>其他住院</strong>：仅有住院的科室归入"其他住院"二级结构</li>
                <li><strong>其他病房</strong>：仅有四级结构住院科室的基础科室归入"其他病房"二级结构</li>
            </ul>
        </div>

        <div id="output">
            <h2><span class="emoji">🎯</span>输出格式</h2>
            
            <h3>输出文件结构</h3>
            <ul>
                <li><strong>文件格式</strong>：Excel文件（.xlsx）</li>
                <li><strong>工作表数量</strong>：4个</li>
                <li><strong>默认保存位置</strong>：输入数据文件所在目录</li>
                <li><strong>文件命名</strong>：目标表格_时间戳.xlsx</li>
            </ul>

            <h3>各工作表内容</h3>

            <h4>1. 医院药品信息表</h4>
            <div class="format-example">
                <ul>
                    <li><strong>数据来源</strong>：从药品使用信息数据中提取唯一药品信息</li>
                    <li><strong>列结构</strong>：
                        <ul>
                            <li>A列：医保编码（从国家编码列复制）</li>
                            <li>B列：医院药品ID（从药品编码列复制）</li>
                            <li>C列：规格转换系数（默认为1）</li>
                            <li>D列：药品名称（从药品名称列复制）</li>
                            <li>E列：规格或规格x包装（从规格列复制）</li>
                            <li>F列：成本价格(元)（从单价列复制）</li>
                        </ul>
                    </li>
                </ul>
            </div>

            <h4>2. 药品使用信息表</h4>
            <div class="format-example">
                <ul>
                    <li><strong>数据来源</strong>：聚合处理后的药品使用信息 + 科室ID映射</li>
                    <li><strong>列结构</strong>：
                        <ul>
                            <li>A列：医保编码</li>
                            <li>B列：医院药品ID</li>
                            <li>C列：科室ID</li>
                            <li>D列：门诊住院</li>
                            <li>E列：院区名</li>
                            <li>F列：时间</li>
                            <li>G列：使用量</li>
                            <li>H列：使用金额</li>
                        </ul>
                    </li>
                </ul>
            </div>

            <h4>3. 科室信息表</h4>
            <div class="format-example">
                <ul>
                    <li><strong>数据来源</strong>：科室结构识别 + 科室结构总表维护</li>
                    <li><strong>列结构</strong>：四级科室层级结构（包含单元格合并）
                        <ul>
                            <li>一级结构ID、一级结构名称</li>
                            <li>二级结构ID、二级结构名称</li>
                            <li>三级结构ID、三级结构名称</li>
                            <li>四级结构ID、四级结构名称</li>
                            <li>门诊住院、院区名</li>
                        </ul>
                    </li>
                </ul>
            </div>

            <h4>4. 药费及人次汇总表</h4>
            <div class="format-example">
                <ul>
                    <li><strong>数据来源</strong>：按科室汇总的药品使用金额</li>
                    <li><strong>列结构</strong>：
                        <ul>
                            <li>A列：时间</li>
                            <li>B列：科室ID</li>
                            <li>C列：药费总额</li>
                            <li>D列：门诊住院</li>
                            <li>E列：院区名</li>
                            <li>F列：诊疗人次（默认为0）</li>
                            <li>G列：平均住院天数（默认为0）</li>
                            <li>H列：住院总人天数（默认为0）</li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>

        <div id="usage">
            <h2><span class="emoji">🚀</span>使用步骤</h2>
            
            <ol class="step-list">
                <li><strong>选择必需文件</strong>：选择1个药品使用信息Excel文件</li>
                <li><strong>配置可选文件</strong>：根据需要勾选并选择科室结构总表</li>
                <li><strong>选择通平台版本</strong>：在下拉框中选择1.4或1.5版本</li>
                <li><strong>设置时间参数</strong>：输入时间（格式：2025年9月）</li>
                <li><strong>设置输出位置</strong>：选择输出文件的保存位置和名称</li>
                <li><strong>开始处理</strong>：点击"开始处理数据"按钮</li>
                <li><strong>等待完成</strong>：查看处理进度和日志信息</li>
            </ol>
        </div>

        <div id="notes">
            <h2><span class="emoji">⚠️</span>注意事项</h2>
            
            <h3>数据文件要求</h3>
            <div class="warning">
                <ul>
                    <li><strong>智能匹配优势</strong>：系统具有强大的智能表头匹配功能，对列名格式要求相对宽松</li>
                    <li><strong>必须列完整性</strong>：药品使用信息文件必须包含核心必须列（系统会自动识别列名变体）</li>
                    <li><strong>数据质量</strong>：确保数据的完整性和准确性，避免大量空值或异常数据</li>
                    <li><strong>编码一致性</strong>：确保药品编码和医保编码的一致性和准确性</li>
                </ul>
            </div>

            <h3>系统使用注意</h3>
            <div class="warning">
                <ul>
                    <li><strong>处理期间</strong>：请勿关闭程序，系统会显示详细的处理进度</li>
                    <li><strong>内存要求</strong>：大数据量处理时确保内存充足</li>
                    <li><strong>日志监控</strong>：关注实时日志显示，了解智能匹配和处理状态</li>
                    <li><strong>错误处理</strong>：系统具有完善的容错机制，会自动处理常见的数据格式问题</li>
                </ul>
            </div>

            <h3>输出特性</h3>
            <div class="info">
                <ul>
                    <li><strong>科室高亮</strong>：新增科室在科室结构总表中自动标记为绿色高亮</li>
                    <li><strong>ID格式保护</strong>：确保科室ID保持正确的前导零格式</li>
                    <li><strong>临时文件清理</strong>：处理完成后自动清理临时文件</li>
                    <li><strong>时间格式</strong>：Excel中时间显示为"2025年9月"格式</li>
                </ul>
            </div>
        </div>

        <div id="dongsoft-features" class="special-feature">
            <h2><span class="emoji">🆕</span>东软版本特性</h2>
            
            <h3>核心优势</h3>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>单文件输入</h4>
                    <p>只需要一个药品使用信息Excel文件即可完成所有处理</p>
                </div>
                <div class="feature-card">
                    <h4>智能表头匹配</h4>
                    <p>强大的自动表头检测和列名映射功能，适配各种数据格式</p>
                </div>
                <div class="feature-card">
                    <h4>数据聚合处理</h4>
                    <p>自动按科室和药品进行数据聚合，避免重复记录</p>
                </div>
                <div class="feature-card">
                    <h4>智能医保编码处理</h4>
                    <p>优先使用国家编码，自动处理医保编码映射</p>
                </div>
                <div class="feature-card">
                    <h4>四级结构支持</h4>
                    <p>完整支持复杂的医院科室层级结构</p>
                </div>
                <div class="feature-card">
                    <h4>版本兼容性</h4>
                    <p>支持通平台1.4和1.5版本的差异化处理</p>
                </div>
            </div>

            <h3>界面优化</h3>
            <ul>
                <li><strong>简化操作</strong>：只需选择一个必需文件，大幅简化操作流程</li>
                <li><strong>Logo集成显示</strong>：120x120像素高清logo，提升专业形象</li>
                <li><strong>颜色标识系统</strong>：新增科室绿色高亮，一目了然</li>
                <li><strong>实时日志反馈</strong>：详细的处理过程和错误信息显示</li>
                <li><strong>进度可视化</strong>：直观的进度条显示处理状态</li>
            </ul>

            <h3>处理优化</h3>
            <ul>
                <li><strong>智能表头检测</strong>：多层次的智能表头检测和列名映射算法</li>
                <li><strong>数据聚合算法</strong>：高效的按科室+药品编码聚合处理</li>
                <li><strong>容错处理</strong>：支持列名变体、特殊字符、数据类型自动转换</li>
                <li><strong>格式保护</strong>：确保科室ID和编码格式的正确性</li>
                <li><strong>错误处理</strong>：完善的异常处理和详细日志记录</li>
                <li><strong>性能优化</strong>：优化大数据量处理性能</li>
            </ul>

            <h3>自动化功能</h3>
            <ul>
                <li><strong>临时文件清理</strong>：自动清理处理过程中的临时文件</li>
                <li><strong>科室结构维护</strong>：动态维护科室结构总表</li>
                <li><strong>颜色标识管理</strong>：自动跟踪和标识新增科室</li>
                <li><strong>数据质量检查</strong>：自动检查和修复数据质量问题</li>
            </ul>
        </div>

        <hr style="margin: 40px 0; border: none; border-top: 2px solid #eee;">
        
        <div style="text-align: center; color: #666; font-size: 14px;">
            <p><strong>版本</strong>: 东软版本</p>
            <p><strong>更新时间</strong>: 2025年</p>
            <p><strong>开发说明</strong>: 东软版本是专门针对东软医院信息系统优化的数据处理工具，具有智能表头检测、单文件输入、数据聚合处理等核心优势。系统能够自动识别和处理各种格式的Excel文件，通过智能算法进行数据聚合和科室结构识别，大幅简化了用户的数据准备工作。特别适合使用东软HIS系统的医疗机构进行数据整理和上报工作。东软版本通过智能匹配、数据聚合和先进的算法技术，确保了数据处理的准确性、效率和易用性。</p>
        </div>
    </div>
</body>
</html>